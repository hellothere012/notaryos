# Enterprise Health Report Threshold Configuration
# NotaryOS v1.5.1
#
# This file defines thresholds for the enterprise health grading system.
# All values are configurable per environment.

version: "1.0"
last_updated: "2026-01-28T00:00:00Z"

# Overall grading thresholds
grading:
  A_plus:
    test_pass_rate: 0.98    # >= 98% tests pass
    error_rate: 0.01        # < 1% error rate
    all_containers_healthy: true
  A:
    test_pass_rate: 0.95    # >= 95% tests pass
    error_rate: 0.02        # < 2% error rate
    max_degraded_containers: 1
  B:
    test_pass_rate: 0.90    # >= 90% tests pass
    error_rate: 0.05        # < 5% error rate
    max_degraded_containers: 2
  C:
    test_pass_rate: 0.80    # >= 80% tests pass
    error_rate: 0.10        # < 10% error rate
    critical_services_required: true
  # Below C thresholds results in F grade

# Container health thresholds
containers:
  cpu_warning: 70          # % - Yellow alert
  cpu_critical: 90         # % - Red alert
  memory_warning: 75       # % - Yellow alert
  memory_critical: 90      # % - Red alert
  restart_threshold: 3     # Restarts in 24h before warning
  uptime_minimum_hours: 1  # Minimum uptime for "stable"

# Performance thresholds (latency in ms)
performance:
  a2a_latency:
    excellent: 3           # P50 < 3ms
    good: 10               # P50 < 10ms
    acceptable: 50         # P50 < 50ms
    # Above acceptable = poor
  a2a_latency_p95:
    excellent: 10          # P95 < 10ms
    good: 50               # P95 < 50ms
    acceptable: 200        # P95 < 200ms
  a2a_latency_p99:
    excellent: 20          # P99 < 20ms
    good: 100              # P99 < 100ms
    acceptable: 500        # P99 < 500ms
  rps_single_thread:
    excellent: 400         # > 400 RPS
    good: 200              # > 200 RPS
    acceptable: 100        # > 100 RPS
  rps_concurrent:
    excellent: 1000        # > 1000 RPS with 10 threads
    good: 500              # > 500 RPS
    acceptable: 200        # > 200 RPS
  throughput_mbps:
    excellent: 3.0         # > 3 Mbps
    good: 1.0              # > 1 Mbps
    acceptable: 0.5        # > 0.5 Mbps
  success_rate:
    excellent: 100         # 100%
    good: 99.9             # >= 99.9%
    acceptable: 99         # >= 99%
    minimum: 95            # Below 95% = critical

# Security thresholds
security:
  zero_trust:
    required: true
    tier: "enterprise"     # Required security tier
  certificate_expiry_days:
    excellent: 90          # > 90 days remaining
    good: 60               # > 60 days
    warning: 30            # > 30 days
    critical: 7            # < 7 days = critical alert
  security_overhead_ms:
    excellent: 1.0         # < 1ms overhead
    good: 2.0              # < 2ms overhead
    acceptable: 5.0        # < 5ms overhead

# Connection pool thresholds
connections:
  redis:
    pool_utilization_warning: 70   # %
    pool_utilization_critical: 90  # %
    min_available: 5               # Minimum idle connections
    latency_warning_ms: 10
    latency_critical_ms: 50
  postgresql:
    pool_utilization_warning: 70   # %
    pool_utilization_critical: 90  # %
    min_available: 5
    latency_warning_ms: 20
    latency_critical_ms: 100
    max_connections: 100

# Agent health thresholds
agents:
  response_time_warning_ms: 100
  response_time_critical_ms: 500
  min_healthy_agents: 2    # Minimum agents required for cluster health
  capability_count_warning: 0  # Warn if agent has no capabilities

# Quick test thresholds (for --quick mode)
quick_tests:
  health_endpoints: 3      # Number of health checks
  a2a_requests: 10         # Number of A2A requests to sample
  timeout_seconds: 30      # Max time for quick mode

# Full test thresholds
full_tests:
  duration_seconds: 120    # Duration for sustained load tests
  concurrent_connections: 100
  warmup_requests: 50

# Alert configurations
alerts:
  # Severity levels: info, warning, critical
  container_down: "critical"
  high_error_rate: "critical"
  high_latency: "warning"
  certificate_expiring: "warning"
  low_rps: "info"

# Report generation
report:
  include_raw_metrics: true
  include_recommendations: true
  max_log_lines: 50
  timestamp_format: "ISO8601"
  markdown_tables: true

# Marketing readiness thresholds
marketing_readiness:
  ready_grade: "B"                  # Minimum grade for "READY" verdict
  blocker_severities: ["critical"]  # Severities that block launch
  max_validation_time_s: 300       # 5-minute hard limit

# Note: Abuse detection, SLO targets, billing configuration, and key rotation
# policies are managed server-side and not included in the open-source distribution.
# See https://docs.agenttownsquare.com/notary/config for hosted configuration.
